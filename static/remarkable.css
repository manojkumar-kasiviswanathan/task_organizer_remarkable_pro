:root{
  --paper:#f7f7f5; --ink:#1a1a1a; --muted:#6d6d6d; --stroke:#d8d8d2;
  --accent:#0a7ea4; --card:#ffffff; --shadow:0 1px 0 rgba(0,0,0,.02), 0 6px 16px rgba(0,0,0,.04);
  --doodle-opacity:.08;
}
:root[data-theme="dark"],
html[data-theme="dark"] {
  --paper: #303136;         /* deep charcoal background */
  --ink: #f5f5f7;           /* softer white text */
  --muted: #a1a1a8;         /* lighter gray for subtext */
  --stroke: #d3d6e2;        /* slightly lighter than paper for borders */
  --accent: #4db2ff;        /* brighter blue accent */
  --card: #2e3038;          /* elevated dark surface */
  --shadow: 0 1px 2px rgba(0,0,0,0.5), 0 6px 20px rgba(0,0,0,0.3); /* subtle depth */
  --doodle-opacity: 0.04;   /* keep doodle faint in dark mode */
}


/* base */
*{box-sizing:border-box;}
html,body{height:100%;}
body{
  margin:0; background:var(--paper); color:var(--ink);
  font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans";
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}

/* doodle */
#bg-doodle{ position:fixed; inset:0; pointer-events:none; background-image:url('bg.jpg'); background-size:600px; background-repeat:repeat; opacity:var(--doodle-opacity); z-index:0; }

/* page */
#page {
  position: relative;
  z-index: 1;
  max-width: 90%;         /* allow full screen */
  width: 90%;
  margin: 48px auto;
  padding: 0 20px;
}

.card {
  background: var(--card);
  border: 1px solid var(--stroke);
  border-radius: 12px;
  padding: 16px;
  margin: 18px auto 24px auto;  /* center the card */
  box-shadow: var(--shadow);
  width: 100%;                  /* take full available width */
}

/* header */
.masthead{ margin-bottom:40px; border-bottom:1px solid var(--stroke); padding-bottom:16px; }
.masthead-row{ display:flex; align-items:center; justify-content:space-between; }
.masthead h1{ margin:0 0 6px 0; font-weight:700; font-size:40px; letter-spacing:.2px; }
.subtitle{ color:var(--muted); margin:0; font-size:18px; }
.controls button{ border:1px solid var(--stroke); background:var(--card); color:var(--ink); border-radius:10px; padding:8px 12px; cursor:pointer; }

/* cards */
.card{ background:var(--card); border:1px solid var(--stroke); border-radius:16px; padding:18px; margin:22px 0 28px 0; box-shadow:var(--shadow); }
.card h2{ margin:0 0 12px 0; font-size:26px; font-weight:700; }
.muted{ color:var(--muted); font-weight:400; }
.group-title{ margin:12px 0 8px 0; font-size:13px; }

/* grid */
.grid{ display:grid; gap:12px; align-items:center; }
.grid.five{ grid-template-columns:1.3fr .6fr .8fr .6fr 1.3fr; }
.head{ font-size:12px; text-transform:uppercase; letter-spacing:.06em; color:var(--muted); border-bottom:1px solid var(--stroke); padding-bottom:8px; }
.head .th{ font-weight:800; text-align:center; }
.row{ position:relative; padding:10px 0; border-bottom:1px solid color-mix(in srgb, var(--stroke) 65%, transparent); }
.row:last-child{ border-bottom:none; }
.inner{ margin-top:8px; }
.cell.completed{ color:color-mix(in srgb, var(--muted) 80%, transparent); text-decoration:line-through; }

/* drag */
.item{ user-select:none; } .item.dragging{ opacity:.5; } .draggable{ min-height:8px; }

/* inputs */
select, input[type=text], textarea, input[type=date], button{ font:inherit; }
select, input[type=text], textarea, input[type=date]{
  width:100%; padding:10px 12px; border:1px solid var(--stroke); background:var(--card); color:var(--ink);
  border-radius:10px; outline:none;
}
textarea.comment-ta{ min-height:42px; resize:vertical; }
select:focus, input[type=text]:focus, textarea:focus, input[type=date]:focus{
  border-color:var(--accent); box-shadow:0 0 0 3px color-mix(in srgb, var(--accent) 20%, transparent);
}
.date-display{
  width:100%; padding:10px 12px; border:1px solid var(--stroke); background:var(--card); color:var(--ink);
  border-radius:10px; outline:none; cursor:pointer;
}
.date-display:focus{
  border-color:var(--accent); box-shadow:0 0 0 3px color-mix(in srgb, var(--accent) 20%, transparent);
}

/* add row */
.add{ margin-top:14px; }
.add button{ justify-self:start; padding:10px 16px; background:var(--ink); color:#fff; border:1px solid var(--ink); border-radius:10px; cursor:pointer; }
.add button:hover{ filter:brightness(1.05); }

/* status */
.status-cell{ display:flex; align-items:center; gap:10px; }
.status-dot{ width:12px; height:12px; border-radius:50%; flex:0 0 12px; }
.status-dot.new{ background:#6c757d; } .status-dot.inprogress{ background:#0a7ea4; } .status-dot.blocked{ background:#d9534f; } .status-dot.complete{ background:#2e8540; }
.status-badge{ display:inline-block; padding:2px 8px; border-radius:10px; font-size:12px; border:1px solid var(--stroke); background:color-mix(in srgb, var(--paper) 70%, transparent); }

/* deadline */
.due-chip{ display:flex; align-items:center; padding:2px; border-radius:10px; }
.due-warn{ background:#fff7d6; border:1px solid #f0d96b; }
.due-danger{ background:#ffe0df; border:1px solid #f1a3a1; }
.due-none{ background:transparent; }

/* tags */
.tags-editor{ display:grid; grid-template-columns:auto 1fr; align-items:start; gap:8px 12px; width:100%; }
.tags-view{ display:flex; align-items:center; flex-wrap:wrap; gap:8px 10px; min-height:40px; }
.tag-add-btn{ padding:8px 12px; border:1px dashed var(--stroke); background:var(--card); border-radius:10px; cursor:pointer; }
.tag-add-btn:hover{ border-color:var(--accent); }
.tag-pill{
  position:relative; height:40px; display:inline-flex; align-items:center;
  padding:0 12px 0 40px; border-radius:999px; color:#fff; font-weight:700; font-size:12px;
  border:0; cursor:pointer; background:#64b5f6; box-shadow:0 1px 0 rgba(0,0,0,.04), 0 4px 10px rgba(0,0,0,.05);
}
.tag-pill::before{
  content:attr(data-n); position:absolute; left:10px; top:50%; transform:translateY(-50%);
  width:22px; height:22px; border-radius:50%; display:grid; place-items:center;
  background:#fff; color:#333; font-size:12px; font-weight:700; box-shadow:0 1px 0 rgba(0,0,0,.05);
}
.tag-x{ font-size:16px; line-height:1; margin-left:6px; opacity:.85; } .tag-x:hover{ opacity:1; }
.tcolor-0{ background:#e57373; } .tcolor-1{ background:#64b5f6; } .tcolor-2{ background:#81c784; } .tcolor-3{ background:#ba68c8; } .tcolor-4{ background:#ffd54f; color:#222; } .tcolor-5{ background:#4db6ac; }

/* markdown */
.md{ white-space:pre-wrap; }
.md ul,.md ol{ margin:.4em 0 .6em 1.2em; } .md li{ margin:.2em 0; } .md p{ margin:.4em 0; }

/* modal */
.modal{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:20; }
.modal.show{ display:flex; }
.modal-backdrop{ position:absolute; inset:0; background:rgba(0,0,0,.25); }
.modal-card{ position:relative; z-index:1; width:min(520px,92vw); background:var(--card); border:1px solid var(--stroke); border-radius:12px; padding:16px; box-shadow:var(--shadow); }
.modal-card h3{ margin:0 0 12px; font-size:18px; }
.modal-card input{ width:100%; padding:10px 12px; border:1px solid var(--stroke); border-radius:10px; background:var(--card); color:var(--ink); }
.modal-card input:focus{ outline:none; border-color:var(--accent); box-shadow:0 0 0 3px color-mix(in srgb, var(--accent) 20%, transparent); }
.modal-actions{ display:flex; gap:10px; justify-content:flex-end; margin-top:12px; }
.modal-actions button{ padding:8px 12px; border-radius:10px; border:1px solid var(--stroke); background:var(--card); cursor:pointer; }
.modal-actions button:last-child{ background:var(--ink); color:#fff; border-color:var(--ink); }

/* responsive */
@media (max-width: 980px){ .grid.five{ grid-template-columns:1fr; } .head .th{ text-align:left; } }

/* Clear-date button inside the deadline chip */
.due-chip{
  position: relative; display: flex; align-items: center; gap: 8px;
  padding: 2px; border-radius: 10px;
}
.due-clear{
  position: absolute; right: 6px; top: 50%; transform: translateY(-50%);
  width: 22px; height: 22px; border-radius: 999px; border: 1px solid var(--stroke);
  background: var(--card); color: var(--muted); cursor: pointer; line-height: 20px;
  display: grid; place-items: center; font-weight: 700; padding: 0;
}
.due-clear:hover{ color: var(--ink); border-color: var(--accent); }

/* make the display input leave room for the clear button */
.due-chip .date-display{ padding-right: 34px; }

/* Comments: auto-expand (no inner scrollbar) */
textarea.comment-ta{ overflow: hidden; }  /* lets height grow with JS */

/* Sticky, glassy masthead */
.masthead.sticky{
  position: sticky;
  top: 0;
  z-index: 10;
  backdrop-filter: saturate(140%) blur(8px);
  background: color-mix(in srgb, var(--paper) 75%, transparent);
  border-bottom: 1px solid var(--stroke);
}

/* Layout */
.brand{ display:flex; align-items:center; gap:12px; }
.logo{
  width:40px; height:40px; border-radius:10px;
  display:grid; place-items:center;
  background: color-mix(in srgb, var(--accent) 14%, var(--card));
  box-shadow: var(--shadow);
  font-size:18px;
}
.titles h1{ margin:0 0 2px 0; line-height:1.1; font-weight:800; letter-spacing:.2px; }
.titles .subtitle{ margin:0; color:var(--muted); font-size:14px; }

/* Right side tools */
.mast-tools{ display:flex; align-items:center; gap:12px; }
.date-chip{
  padding:6px 10px; border:1px solid var(--stroke);
  background: color-mix(in srgb, var(--card) 85%, transparent);
  border-radius:999px; font-size:12px; font-weight:600; color:var(--ink);
}
.sep{
  width:1px; height:26px; background: var(--stroke); display:inline-block;
}

/* Icon buttons */
.icon-btn{
  border:1px solid var(--stroke);
  background: var(--card);
  color: var(--ink);
  border-radius:10px;
  padding:8px 12px;
  cursor:pointer;
  transition: transform .08s ease, border-color .15s ease;
}
.icon-btn:hover{ border-color: var(--accent); transform: translateY(-1px); }
.icon-btn:active{ transform: translateY(0); }

/* Dark-mode tweaks for the glass header (optional) */
:root[data-theme="dark"] .masthead.sticky{
  background: color-mix(in srgb, var(--paper) 70%, transparent);
}
:root[data-theme="dark"] .logo{
  background: color-mix(in srgb, var(--accent) 18%, var(--card));
}

/* Tag color palette (12 hues) */
.tcolor-0  { background:#e57373; }  /* soft red    */
.tcolor-1  { background:#64b5f6; }  /* soft blue   */
.tcolor-2  { background:#81c784; }  /* soft green  */
.tcolor-3  { background:#ba68c8; }  /* soft purple */
.tcolor-4  { background:#ffd54f; color:#222; } /* amber */
.tcolor-5  { background:#4db6ac; }  /* teal */
.tcolor-6  { background:#ff8a65; }  /* coral */
.tcolor-7  { background:#9575cd; }  /* violet */
.tcolor-8  { background:#4fc3f7; }  /* sky */
.tcolor-9  { background:#aed581; }  /* lime */
.tcolor-10 { background:#f06292; }  /* pink */
.tcolor-11 { background:#a1887f; }  /* brown */


